!function(a){a.fn.ImxInfiniteScroll=function(t,n){var e=a.extend({api_url:"http://api.inventmx.com/v1",site:"salud180",repo:"nodes.json",api_key:"3a5877fc16b6fcbf8eedbe55d091938a",append:"body",loading:"http://m.salud180.com/img/salud180/ajax-loader.gif",analitics:!0,category_analytics:"IMxInfiniteScroll",action_analytics:"Infinite-Scroll",label_analytics:"Numero-Scroll: ",infinite_scroll:!0,IMxInit:function(){},IMxEnd:function(){}},t),i=a.extend({sort:null,type:null,fields:null,limit:5,offset:null,audio:null,tag_ids:null,category_url:null,category_ids:null,programa_url:null,programa_ids:null,tag_url:null,callback:null,columnista_ids:null},n),l=a(this).attr("id"),o=!1,r="";a(e.append).after("<div class='wrapper-loading'><img src='"+e.loading+"'/></div>"),a(e.append+" img").each(function(){a(this).css({"background-image":"url("+e.loading+")"}),a(this).addClass("loading")}),i.offset?(offset1=i.offset+i.limit,a("#"+l).attr("offset",offset1)):a("#"+l).attr("offset",i.limit);var s=0,c={analitics:function(){e.analitics&&(url=window.location.href,label=e.label_analytics+s,_gaq.push(["_trackEvent",url,e.category_analytics,e.action_analytics,label]))},init:function(){c.load()},load:function(){offset=parseInt(a("#"+l).attr("offset")),i.offset=offset,url=e.api_url+"/"+e.site+"/"+e.repo+"/"+e.api_key+"?callback=?",finaldata={},a.each(i,function(a,t){t&&(finaldata[a]=t)}),c.getAjax(url,finaldata)},getAjax:function(t,n){o=!0,a.ajax({url:t,data:n,dataType:"json",type:"GET",timeout:1e5,contentType:"application/json; charset=utf-8",async:!1,success:function(t){200==t.response.status?(result=t.data,t?c.render(result):alert("No hay mas datos"),o=!1):(l=a(block).attr("id"),alert("Hubo un error inesperado, intenta nuevamente por favor"),o=!1)},error:function(){alert("Hubo un error inesperado, intenta nuevamente por favor"),o=!1}})},render:function(t){o=!1,s+=1,offset=parseInt(a("#"+l).attr("offset")),offset+=i.limit,a("#"+l).attr("offset",offset),tpl=a("#"+l).html(),section=Handlebars.compile(tpl),r=section(t),a(e.append).append(r),a(".wrapper-loading").hide(),jQuery("#id-infinite-load-see-more").show(),c.analitics(),e.IMxEnd()}};e.infinite_scroll?a(window).scroll(function(){a(window).scrollTop()!=a(document).height()-a(window).height()||o||(c.init(),e.IMxInit(),a(".wrapper-loading").show())}):jQuery("#relacionados-wrapper").delegate("#id-infinite-load-see-more","click",function(t){t.preventDefault(),jQuery("#id-infinite-load-see-more").hide(),a(".wrapper-loading").show(),e.IMxInit(),c.init()})}}(jQuery);